CREATE database ASSIGNMENT3;
USE ASSIGNMENT3;
CREATE TABLE DEPARTMENT(
DEPT_ID INT NOT NULL PRIMARY KEY,
DEPT_NAME VARCHAR(50));
/*CONSTRAINT FK_DEPTID FOREIGN KEY (DEPT_ID) REFERENCES EMPLOYEE (DEPT_ID));*/

CREATE TABLE EMPLOYEE(
EMP_ID INT NOT NULL PRIMARY KEY,
EMP_NAME VARCHAR(50),
DEPT_ID INT,
SALARY INT,
MANAGER INT,
FOREIGN KEY (DEPT_ID) REFERENCES DEPARTMENT(DEPT_ID)
);
DROP TABLE EMPLOYEE;
INSERT INTO DEPARTMENT VALUES (1,'FINANCE');
INSERT INTO DEPARTMENT VALUES(2,'TRAINING');
INSERT INTO DEPARTMENT VALUES(3,'MARKETING');
SELECT * FROM DEPARTMENT;
TRUNCATE TABLE EMPLOYEE;
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,DEPT_ID,SALARY,MANAGER) VALUES (1,'ARUN',1,8000,4);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,DEPT_ID,SALARY,MANAGER) VALUES (2,'KIRAN',1,8000,1);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,DEPT_ID,SALARY,MANAGER) VALUES (3,'SCOTT',1,8000,1);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,DEPT_ID,SALARY) VALUES (4,'MAX',2,8000);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,DEPT_ID,SALARY,MANAGER) VALUES (5,'JACK',2,8000,4);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,SALARY,MANAGER) VALUES (6,'KING',6000,1);

SELECT * , sum(SALARY) FROM EMPLOYEE group by DEPT_ID;

SELECT *,SUM(SALARY) FROM EMPLOYEE GROUP BY DEPT_ID HAVING SUM(SALARY)>17000;

SELECT *,SUM(SALARY) FROM EMPLOYEE GROUP BY DEPT_ID HAVING SUM(SALARY)>18000;

SELECT *,SUM(SALARY) FROM EMPLOYEE GROUP BY DEPT_ID HAVING SUM(SALARY)<20000;

